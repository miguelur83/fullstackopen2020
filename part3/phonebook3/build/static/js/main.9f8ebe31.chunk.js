(this.webpackJsonpphonebook=this.webpackJsonpphonebook||[]).push([[0],{37:function(e,n,t){},38:function(e,n,t){"use strict";t.r(n);var c=t(0),o=t(2),a=t.n(o),r=t(14),i=t.n(r),u=t(4),s=t(3),l=t.n(s),d="/api/persons",f=function(e){return l.a.post(d,e).then((function(e){return e.data}))},b=function(e,n){return l.a.put("".concat(d,"/").concat(e),n).then((function(e){return e.data}))},j=function(e){return l.a.delete("".concat(d,"/").concat(e)).then((function(e){return e.data}))},h=function(e){var n=e.filterHandler;return Object(c.jsxs)("div",{children:["filter by name: ",Object(c.jsx)("input",{onChange:n})]})},m=function(e){var n=e.message,t=e.type;return null===n?null:Object(c.jsx)("div",{className:t,children:n})},O=function(e){return Object(c.jsxs)("form",{onSubmit:e.handleOnSubmit,children:[Object(c.jsxs)("div",{children:["name: ",Object(c.jsx)("input",{onChange:e.handleNameChange})]}),Object(c.jsxs)("div",{children:["number: ",Object(c.jsx)("input",{onChange:e.handleNumberChange})]}),Object(c.jsx)("div",{children:Object(c.jsx)("button",{type:"submit",children:"add"})})]})},p=function(e){var n=e.persons,t=e.filter,o=e.handleDelete;return Object(c.jsx)("ul",{children:n.filter((function(e){return e.name.toLowerCase().includes(t.toLowerCase())})).map((function(e){return Object(c.jsx)(g,{person:e,handleDelete:o},e.name)}))})},g=function(e){var n=e.person,t=e.handleDelete;return Object(c.jsxs)("li",{children:[n.name,": ",n.number," ",Object(c.jsx)("button",{id:n.id,onClick:t,children:"delete"})]},n.name)},x=function(){var e=Object(o.useState)([]),n=Object(u.a)(e,2),t=n[0],a=n[1],r=Object(o.useState)(""),i=Object(u.a)(r,2),s=i[0],d=i[1],g=Object(o.useState)(""),x=Object(u.a)(g,2),v=x[0],w=x[1],y=Object(o.useState)(""),S=Object(u.a)(y,2),k=S[0],C=S[1],D=Object(o.useState)(null),N=Object(u.a)(D,2),T=N[0],E=N[1],H=Object(o.useState)(null),I=Object(u.a)(H,2),J=I[0],L=I[1];Object(o.useEffect)((function(){console.log("effect"),l.a.get("https://safe-reef-89727.herokuapp.com/api/persons").then((function(e){a(e.data),console.log(e.data)}))}),[]);return Object(c.jsxs)("div",{children:[Object(c.jsx)("h2",{children:"Phonebook"}),Object(c.jsx)(m,{message:J,type:"notification"}),Object(c.jsx)(m,{message:T,type:"error"}),Object(c.jsx)(h,{filterHandler:function(e){C(e.target.value)}}),Object(c.jsx)("h3",{children:"Add a new person"}),Object(c.jsx)(O,{handleOnSubmit:function(e){e.preventDefault();var n={name:s,number:v};if(console.log("button clicked",e.target),-1!==t.findIndex((function(e){return e.name===s}))){console.log("FOUND");var c=t.find((function(e){return e.name===s}));v!=c.number?window.confirm("".concat(s," is already added to phonebook. Do you want to update their number?"))&&(c.number=v,b(c.id,c).then((function(e){a(t.map((function(e){return e.id===c.id?c:e}))),console.log(e),L("".concat(c.name,"'s number was updated to the server")),setTimeout((function(){L(null)}),5e3)})).catch((function(e){E("".concat(c.name," was already deleted from the server")),a(t.filter((function(e){return e.id!=c.id}))),setTimeout((function(){E(null)}),5e3)}))):(E("".concat(s," is already added to phonebook")),setTimeout((function(){E(null)}),5e3))}else console.log("Saving person"),f(n).then((function(e){a(t.concat(e)),L("".concat(e.name," was saved to the server")),setTimeout((function(){L(null)}),5e3)}))},handleNameChange:function(e){d(e.target.value)},handleNumberChange:function(e){w(e.target.value)}}),Object(c.jsx)("h3",{children:"Numbers"}),Object(c.jsx)(p,{persons:t,filter:k,handleDelete:function(e){var n=t.find((function(n){return n.id==e.target.id}));window.confirm("Do you really want to delete ".concat(n.name,"?"))&&(console.log("Delete ",e.target.id),j(e.target.id).then((function(n){console.log(n),a(t.filter((function(n){return n.id!=e.target.id})))})).catch((function(e){E("".concat(n.name," was already deleted from the server")),a(t.filter((function(e){return e.id!=n.id}))),setTimeout((function(){E(null)}),5e3)})))}})]})};t(37);i.a.render(Object(c.jsx)(a.a.StrictMode,{children:Object(c.jsx)(x,{})}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.9f8ebe31.chunk.js.map